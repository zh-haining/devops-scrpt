pipeline {
   agent any
   parameters {
      choice(choices: ['dev','test-9091', 'test9092', 'pre-9080','prod'], description: '选择环境', name: 'env_type')

      string(defaultValue: 'master', description: '分支名称', name: 'branch_name', trim: true)

   }
   stages {
      stage('拉取代码') {
            parallel {
                stage('拉取项目A的代码') {
                    steps {
                        echo "正在拉取项目A的代码"
                        sleep 5
                        echo "项目A代码拉取完毕"
                    }
                }
                stage('拉取项目B的代码') {
                    steps {
                        echo "正在拉取项目B的代码"
                        sleep 8
                        echo "项目B代码拉取完毕"
                    }
                }
                stage('拉取项目C的代码') {
                    steps {
                        echo "正在拉取项目B的代码"
                        sleep 3
                        echo "项目C代码拉取完毕"
                    }
                }
            }

      }
      stage('编译构建') {
          steps{
                echo "编译构建开始..."
                sleep 5
                echo "编译构建完毕!"
          }
      }
       stage('集群发布') {
           steps{

               input message: '请选择发布主机', parameters: [choice(choices: ['192.168.1.100', '192.168.1.101', '192.168.1.102', '192.168.1.103', '192.168.1.104'], description: '请选择主机列表', name: 'hostList'), choice(choices: ['串行'], description: '并行', name: '串行发布还是并行发布')], submitterParameter: 'selectHosts'
               echo "集群发布开始..."
               sleep 2
               echo "集群发布完毕!"
           }
      }
      stage('通知') {
           steps {
               echo "通知完成"
          }
       }
   }
}
